<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.5//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.secondhandauctions.dao.MemberDao">

    <!--  기존 회원  -->
    <select id="idCheck" parameterType="String" resultType="int">
        select
            count(*)
        from
            member
        where
            memberId = #{memberId}
            and isMemberCheck = 1

    </select>

    <!--  회원가입  -->
    <insert id="join" parameterType="com.secondhandauctions.vo.MemberVo">
        insert into member
        (
            memberId, memberName, memberPassword, memberEmail, memberPhone
        )
        values
        (
            #{memberId}, #{memberName}, #{memberPassword}, #{memberEmail}, #{memberPhone}
        )
    </insert>

    <!--  로그인  -->
    <select id="login" parameterType="java.util.Map" resultType="int">
        select
            count(*)
        from
            member
        where
            memberId = #{memberId} and
            memberPassword = #{memberPassword} and
            isMemberCheck = 1;
    </select>

    <!--  회원 정보 가져오기  -->
    <select id="memberInfo" parameterType="String" resultType="com.secondhandauctions.vo.MemberVo">
        select
            memberId, memberName, memberPassword, memberEmail, memberPhone
        from
            member
        where
            memberId = #{memberId} and
            isMemberCheck = 1;
    </select>

    <!--  회원 존재 확인(이메일)  -->
    <select id="isMemberEmail" parameterType="String" resultType="int">
        select
            count(*)
        from
            member
        where
            memberEmail = #{memberEmail} and
            isMemberCheck = 1;
    </select>

    <!--  회원 존재 확인(핸드폰)  -->
    <select id="isMemberPhone" parameterType="java.util.Map" resultType="int">
        select
            count(*)
        from
            member
        where
            memberPhone = #{memberPhone} and
            memberName = #{memberName} and
            isMemberCheck = 1;
    </select>


    <!--  아이디 찾기  -->
    <select id="searchIdEmail" parameterType="String" resultType="String">
        select
            memberId
        from
            member
        where
            memberEmail = #{memberEmail} and
            isMemberCheck = 1;
    </select>

    <select id="searchIdPhone" parameterType="java.util.Map" resultType="String">
        select
            memberId
        from
            member
        where
            memberPhone = #{memberPhone} and
            memberName = #{memberName} and
            isMemberCheck = 1;
    </select>

    <!--  비밀번호 찾기  -->
    <select id="checkSearchPwdPhone" parameterType="java.util.Map" resultType="int">
        select
            count(*)
        from
            member
        where
            memberName = #{memberName} and
            memberId = #{memberId} and
            memberPhone = #{memberPhone} and
            isMemberCheck = 1;
    </select>

    <select id="checkSearchPwdEmail" parameterType="java.util.Map" resultType="int">
        select
            count(*)
        from
            member
        where
            memberId = #{memberId} and
            memberEmail = #{memberEmail} and
            isMemberCheck = 1;
    </select>


    <select id="getPasswordFromPhone" parameterType="java.util.Map" resultType="String">
        select
            memberPassword
        from
            member
        where
            memberName = #{memberName} and
            memberId = #{memberId} and
            memberPhone = #{memberPhone} and
            isMemberCheck = 1;
    </select>

    <select id="getPasswordFromEmail" parameterType="java.util.Map" resultType="String">
        select
            memberPassword
        from
            member
        where
            memberId = #{memberId} and
            memberEmail = #{memberEmail} and
            isMemberCheck = 1;
    </select>


</mapper>